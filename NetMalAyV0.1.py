from scapy.all import *

# Function to analyze network traffic
def analyze_network_traffic(packet):
    if packet.haslayer(TCP):
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst
        src_port = packet[TCP].sport
        dst_port = packet[TCP].dport

        print(f"TCP Packet: {src_ip}:{src_port} --> {dst_ip}:{dst_port}")

    elif packet.haslayer(UDP):
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst
        src_port = packet[UDP].sport
        dst_port = packet[UDP].dport

        print(f"UDP Packet: {src_ip}:{src_port} --> {dst_ip}:{dst_port}")

# Main function
def network_malware_analysis():
    print("Starting network malware analysis...")

    # Set the network interface to capture traffic
    interface = "eth0"

    # Start sniffing network traffic
    sniff(iface=interface, prn=analyze_network_traffic)

# Execute the main function
if __name__ == '__main__':
    network_malware_analysis()
